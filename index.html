<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>××¢×§×‘ ×”×•×¦××•×ª</title>

<style>
:root{
  --bg: #f3f5f9;
  --card-bg: #ffffff;
  --muted: #6b7280;
  --accent: #4caf50;
  --radius: 14px;
  --container-padding: 14px;
  --stat-font: 17px;
}

/* ×‘×¡×™×¡×™ */
*{box-sizing:border-box}
html,body{height:100%}
body{
  font-family: system-ui, Arial, sans-serif;
  background: linear-gradient(180deg,#f6f8fc,#eef2f7);
  margin:0;
  padding: var(--container-padding);
  direction: rtl;
  color: #0f172a;
}

/* ×›×¨×˜×™×¡×™× */
.card{
  background: var(--card-bg);
  border-radius: var(--radius);
  padding:14px 14px 12px;
  margin-bottom:14px;
  box-shadow: 0 8px 24px rgba(15,23,42,0.06);
}

/* ×›×•×ª×¨×•×ª */
h2{
  margin:4px 0 10px;
  font-size:18px;
  font-weight:700;
}

/* ×©×•×¨×•×ª × ×ª×•× ×™× */
.row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin:6px 0;
  font-size: var(--stat-font);
}

/* ×¢×¨×›×™× */
.row > span:last-child{
  min-width:110px;
  text-align:center;
  font-weight:700;
}

/* ===== ×ª×§×¦×™×‘ ===== */

#budgetLeft{
  display:inline-block;
  min-width:120px;
  font-weight:800;
  font-size:20px;
  padding:8px 12px;
  border-radius:999px;
  color:#fff;

  --percent: 100%;
  --budget-color: #22c55e;

  background:
    linear-gradient(90deg,
      var(--budget-color) 0%,
      var(--budget-color) var(--percent),
      rgba(255,255,255,0.15) var(--percent),
      rgba(255,255,255,0.05) 100%);

  box-shadow: 0 6px 16px rgba(0,0,0,0.12);
  transition: all .25s ease;
  white-space:nowrap;
}

#budgetLeft.positive{ --budget-color: #22c55e; }
#budgetLeft.warning{  --budget-color: #f59e0b; }
#budgetLeft.danger{
  --budget-color: #ef4444;
  animation: pulse 1.1s infinite;
}

@keyframes pulse{
  0%{ transform: scale(1); }
  50%{ transform: scale(1.03); }
  100%{ transform: scale(1); }
}

/* ===== ×˜×¤×¡×™× ===== */

input, button{
  width:100%;
  padding:10px;
  font-size:17px;
  margin-top:8px;
  border-radius:10px;
  border:1px solid #e5e7eb;
  background:#fff;
  color:#0f172a;
}

input:focus{
  outline:none;
  border-color:#60a5fa;
  box-shadow:0 0 0 2px rgba(96,165,250,0.2);
}

button{
  background: linear-gradient(180deg,#4caf50,#3f9e47);
  color:white;
  border:none;
  cursor:pointer;
  font-weight:700;
}

button:active{ transform: translateY(1px); }
button:disabled{ opacity:0.6; }

/* ===== ×¨×©×™××ª ×§× ×™×•×ª ===== */

.list-item{
  padding:10px 4px;
  border-bottom:1px solid #f1f5f9;
  font-size:15px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.list-item::before{
  content: "";
  width:8px;
  height:8px;
  border-radius:50%;
  background:#3b82f6;
  margin-inline-start:10px;
}

/* ××•×‘×™×™×œ */
@media (max-width:420px){
  body{ padding:12px; }
  .row{ font-size:15px; }
  #budgetLeft{ font-size:18px; }
}

</style>
</head>

<body>

<div class="card" id="statsCard">
  <h2>× ×ª×•× ×™×</h2>
  <div class="row"><span>ğŸ’³ ×××–×Ÿ ×‘× ×§</span><span id="balance">0 â‚ª</span></div>
  <div class="row"><span>ğŸ“… ×ª×§×¦×™×‘ ×—×•×“×©×™</span><span id="budget">0 â‚ª</span></div>
  <div class="row"><span>ğŸ“Š × ×©××¨ ×‘×ª×§×¦×™×‘</span><span id="budgetLeft">0 â‚ª</span></div>
  <div class="row"><span>ğŸ’° ×”×›× ×¡×”</span><span id="income">0 â‚ª</span></div>
  <div class="row"><span>ğŸ’³ ×—×™×•×‘ ×”××©×¨××™ ×‘22 ×œ×—×•×“×© ×‘×¢×•×“</span><span id="daysTo22">â€”</span></div>
 <span class="row">ğŸ“† (28/×œ×—×•×“×©)-×‘×¢×•×“
  <span id="daysTo28">â€”</span>
   </span>
</div>

<div class="card" id="setupCard">
  <h2>×”×’×“×¨×” ×¨××©×•× ×™×ª</h2>
  <input id="incomeInput" type="number" placeholder="×”×›× ×¡×” ×—×•×“×©×™×ª â‚ª">
  <input id="budgetInput" type="number" placeholder="×ª×§×¦×™×‘ ×—×•×“×©×™ â‚ª">
  <button onclick="saveSetup()">×©××•×¨</button>
</div>

<div class="card" id="buyCard" style="display:none;">
  <h2>×§× ×™×™×” ×—×“×©×”</h2>
  <div class="row">
</div>
  <input id="buyInput" type="number" placeholder="×¡×›×•× ×§× ×™×™×” â‚ª">
  <button onclick="addPurchase()">×”×•×¡×£ ×§× ×™×™×”</button>
</div>

<div class="card">
  <h2>×¨×©×™××ª ×§× ×™×•×ª</h2>
  <div id="list"></div>
</div>

<script>
let data = {
  balance: 0,
  income: 0,
  budget: 0,        // ×”×ª×§×¦×™×‘ ×”×—×•×“×©×™ ×”×§×‘×•×¢ (1500 ×œ××©×œ)
  budgetLeft: 0,    // ×›××” × ×©××¨ ×‘×¤×•×¢×œ
  lastSalaryMonth: null,
  purchases: []
};


function checkMonthlySalary(){
  const now = new Date();
  const day = now.getDate();
  const monthKey = now.getFullYear() + "-" + (now.getMonth()+1);

  if(day >= 28 && data.lastSalaryMonth !== monthKey){
    // ××©×›×•×¨×ª × ×›× ×¡×ª ×œ×‘× ×§
    data.balance += data.income;

    // ×”×ª×§×¦×™×‘ ××ª×•×•×¡×£ ×œ××” ×©× ×©××¨ / ××™× ×•×¡
    data.budgetLeft += data.budget;

    data.lastSalaryMonth = monthKey;
    save();
  }
}


function load(){
  const saved = localStorage.getItem("bankApp");
  if(saved){
    data = JSON.parse(saved);
    document.getElementById("setupCard").style.display="none";
    document.getElementById("buyCard").style.display="block";
  }

  checkMonthlySalary(); 
updateDaysTo28();
updateDaysTo22();   // â† ×—×“×©
render();
}

function save(){
  localStorage.setItem("bankApp", JSON.stringify(data));
}

  function updateDaysTo28(){
  const now = new Date();

  let target = new Date(
    now.getFullYear(),
    now.getMonth(),
    28, 0, 0, 0, 0
  );

  // ×× ×¢×‘×¨× ×• ××ª ×”-28, ×”×•×œ×›×™× ×œ-28 ×©×œ ×”×—×•×“×© ×”×‘×
  if(now > target){
    target = new Date(
      now.getFullYear(),
      now.getMonth() + 1,
      28, 0, 0, 0, 0
    );
  }

  const diffMs = target - now;
  const days = Math.ceil(diffMs / (1000 * 60 * 60 * 24));

  if(days === 0){
    document.getElementById("daysTo28").innerText = "×”×™×•× ğŸ‰";
  }else{
    document.getElementById("daysTo28").innerText = days + " ×™××™×";
  }
}
  
  function updateDaysTo22(){
  const now = new Date();

  let target = new Date(
    now.getFullYear(),
    now.getMonth(),
    22, 0, 0, 0, 0
  );

  // ×× ×¢×‘×¨× ×• ××ª ×”-22, ×”×•×œ×›×™× ×œ-22 ×©×œ ×”×—×•×“×© ×”×‘×
  if(now > target){
    target = new Date(
      now.getFullYear(),
      now.getMonth() + 1,
      22, 0, 0, 0, 0
    );
  }

  const diffMs = target - now;
  const days = Math.ceil(diffMs / (1000 * 60 * 60 * 24));

  if(days === 0){
    document.getElementById("daysTo22").innerText = "×”×™×•× ğŸ’³";
  }else{
    document.getElementById("daysTo22").innerText = days + " ×™××™×";
  }
}
  
function render(){
  balance.innerText = data.balance + " â‚ª";
  income.innerText = data.income + " â‚ª";
  budget.innerText = data.budget + " â‚ª";
  budgetLeft.innerText = data.budgetLeft + " â‚ª";

  const listDiv = document.getElementById("list");
  listDiv.innerHTML="";
  data.purchases.forEach((p,i)=>{
    const d = new Date(p.time);
    const line = document.createElement("div");
    line.className="list-item";
    line.innerText = 
      (i+1)+". â‚ª"+p.amount+
      " â€” "+d.toLocaleDateString()+" "+
      d.toLocaleTimeString().slice(0,5);
    listDiv.appendChild(line);
  });
}

function saveSetup(){
  const inc = Number(incomeInput.value);
  const bud = Number(budgetInput.value);
  if(!inc || !bud) return alert("××œ× ×”×›× ×¡×” ×•×ª×§×¦×™×‘");

  const now = new Date();
  const monthKey = now.getFullYear() + "-" + (now.getMonth()+1);

  data.income = inc;     // ××©×›×•×¨×ª ×—×•×“×©×™×ª ×§×‘×•×¢×”
  data.budget = bud;    // ×ª×•×¡×¤×ª ×ª×§×¦×™×‘ ×—×•×“×©×™×ª ×§×‘×•×¢×”

  data.balance += inc;      // ××©×›×•×¨×ª ×¨××©×•× ×” × ×›× ×¡×ª ××™×“
  data.budgetLeft += bud;  // ×ª×§×¦×™×‘ ×¨××©×•×Ÿ × ×›× ×¡ ××™×“

  data.lastSalaryMonth = monthKey; // ××¡××Ÿ ×©×§×™×‘×œ×ª ×”×—×•×“×©

  save();

  setupCard.style.display="none";
  buyCard.style.display="block";
  render();
  updateDaysTo28();
}


function addPurchase(){
  const val = Number(buyInput.value);
  if(!val) return;

  data.balance -= val;
  data.budgetLeft -= val;

  data.purchases.push({
    amount: val,
    time: Date.now()
  });

  buyInput.value="";
  save();
  render();
}

load();
</script>

</body>
</html>
